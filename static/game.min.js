var stage,drawStage,w,h,loader,startLoader,lateLoader,endLoader,background,waterSheet,explodeSheet,painting,music,startCanvas,mouth_explode,star,bgm,handleMove,initalScore,loadText,star_number_sm,star_number,loadLine,currentX,currentY,currentWidth,touchX,touchY,hasDrawn=!1,hasClicked=!1,scaleY,ratio,peopleLists=[],timeoutList=[],lifeValue=10,ROLE_SCALE=520/300,score=0,hasLevelUp=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],oldArray=[],networkType="unknown",feedback={},stats={},timeoutDev,timeoutPM,timeoutBoss,pageUrl=window.location.href.split("#")[0],pagePath=window.location.pathname,trainee,pm,dev,boss,textIndex=0,hasStarted=!1,ACTOR_WIDTH=300,heightScale=.90390625,shareTitle,shareContent,shareImage,result_bg_dark,hor2ver,startTime,endTime;window.localStorage.hasOwnProperty("enableTutorial")||window.localStorage.setItem("enableTutorial",!0);ratio=1157/720;var loadCanvas=document.getElementById("loadCanvas");loadCanvas.height=window.innerHeight;loadCanvas.width=window.innerHeight/ratio;stage=new createjs.Stage(loadCanvas);h=stage.canvas.height;scaleY=h/1157;if(0>navigator.userAgent.indexOf("iPhone")&&0>navigator.userAgent.indexOf("Android")){w=h/ratio;var windowWidth=window.innerWidth;$(".game-board").css("left",(windowWidth-w)/2)}else window.innerHeight<window.innerWidth?(alert("\u7ad6\u7740\u73a9\u59ff\u52bf\u66f4\u5e05\uff01"),window.location.href=location.href+"?time\x3d"+(new Date).getTime()):(w=stage.canvas.width,$(".game-board").css({width:"100%",height:"100%"}));stats.path=pagePath;switch(pagePath){case "/shutup/ch0":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch1":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch2":shareTitle="\u6211\u5c31\u559c\u6b22\u4f60\u770b\u4e0d\u60ef\u6211\uff0c\u53c8\u6253\u4e0d\u6b7b\u6211\u7684\u6837\u5b50\uff01";shareContent="\u5feb\u70b9\u6211\u5440\uff0c\u4f60\u597d\u574f\u54e6";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch3":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch4":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch5":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch6":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch7":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch8":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch9":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch10":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch11":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch12":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch13":shareTitle="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareContent="\u8fd9\u662f\u4e27\u903c\u8bbe\u8ba1\u5e08\u5f00\u53d1\u7684\u6700\u4e0d\u9760\u8c31\u6e38\u620f\uff0c\u5df2\u706b\u7206\u8bbe\u8ba1\u5708\u3002\u7cfb\u597d\u5b89\u5168\u5e26\uff0c\u6211\u4eec\u8981\u8d77\u98de\u4e86\u3002";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch14":shareTitle="\u79d8\u7b08\uff1a\u70b9\u51fb\u53e3\u6c34\u540e\uff0c\u7ed3\u679c\u7adf\u7136\u53d8\u6210\u8fd9\u6837!";shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch15":shareTitle="\u6211\u5988\u73a9\u5b8c\u8fd9\u4e2a\u6e38\u620f\uff0c\u51c6\u5907\u8f6c\u884c\u505a\u8bbe\u8ba1\u4e86\uff01";shareContent="\u4f60\u5988\u558a\u4f60\u56de\u5bb6\u505a\u8bbe\u8ba1\uff5e";shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png";break;case "/shutup/ch16":shareTitle="\u6211\u5c31\u559c\u6b22\u4f60\u770b\u4e0d\u60ef\u6211\uff0c\u53c8\u6253\u4e0d\u6b7b\u6211\u7684\u6837\u5b50\uff01",shareContent="\u5feb\u70b9\u6211\u5440\uff0c\u4f60\u597d\u574f\u54e6",shareImage="http://research-h5.lenovo.com/shutup/_assets/art/share_icon.png"}function configureSharing(a){$.ajax({type:"POST",url:"/shutup/sign",data:{url:pageUrl},success:function(c){if(a){var b=endTime-startTime,d=parseInt(100*(a.total-a.rank+1)/a.total);shareTitle=99<=d?"\u6ca1\u60f3\u5230\uff01\u6211\u7adf\u6491\u4e86"+(b/1E3).toFixed(2)+"\u79d2\uff0c\u6210\u529f\u8dfb\u8eab\u5168\u7403\u524d1%,\u540d\u5217"+(a.rank+1)+"\u3002":"\u6ca1\u60f3\u5230\uff01\u6211\u7adf\u6491\u4e86"+(b/1E3).toFixed(2)+"\u79d2\uff0c\u8d85\u8fc7\u5168\u7403"+d+"%\u7684\u8bbe\u8ba1\u5e08\u3002"}wx.config({debug:!1,appId:c.appId,timestamp:c.timestamp,nonceStr:c.noncestr,signature:c.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareQZone","getNetworkType"]});wx.ready(function(){wx.getNetworkType({success:function(a){networkType=a.networkType}});wx.onMenuShareTimeline({title:shareTitle,link:pageUrl,imgUrl:shareImage});wx.onMenuShareAppMessage({title:shareTitle,desc:shareContent,link:pageUrl,imgUrl:shareImage,type:"link"});wx.onMenuShareQQ({title:shareTitle,desc:shareContent,link:pageUrl,imgUrl:shareImage,success:function(){},cancel:function(){}});wx.onMenuShareQZone({title:shareTitle,desc:shareContent,link:pageUrl,imgUrl:shareImage,success:function(){},cancel:function(){}})});wx.error(function(a){JSON.stringify(a)})},error:function(a){console.log(a)}})}configureSharing(!1);function init(){var a=[{src:"audio/bgm.mp3",id:"bgm"},{src:"audio/appear.mp3",id:"appear"},{src:"audio/drop.mp3",id:"drop"},{src:"audio/explode.wav",id:"explode"},{src:"audio/open_mouth.mp3",id:"open_mouth"},{src:"audio/result.mp3",id:"result"},{src:"audio/score.mp3",id:"score"},{src:"audio/shutup.mp3",id:"shutup"},{src:"start_mouth.png",id:"start-mouth"},{src:"start_actor.png",id:"start-actor"},{src:"title.png",id:"title"},{src:"start_guide.png",id:"guide"},{src:"explode.png",id:"explode"},{src:"wording.png",id:"wording"},{src:"actors.png",id:"actor"},{src:"title.png",id:"title"},{src:"intern.png",id:"intern"},{src:"intern2.png",id:"intern2"},{src:"boss-1.png",id:"boss-1"},{src:"boss-2.png",id:"boss-2"},{src:"boss-3.png",id:"boss-3"},{src:"boss-4.png",id:"boss-4"},{src:"boss-5.png",id:"boss-5"},{src:"boss-6.png",id:"boss-6"},{src:"dev-1.png",id:"dev-1"},{src:"dev-2.png",id:"dev-2"},{src:"dev-3.png",id:"dev-3"},{src:"pm-1.png",id:"pm-1"},{src:"pm-2.png",id:"pm-2"},{src:"pm-3.png",id:"pm-3"},{src:"bg.png",id:"background"},{src:"bg2.png",id:"background2"},{src:"bg_dark.png",id:"background_dark"},{src:"painting.png",id:"painting"},{src:"painting2.png",id:"painting2"},{src:"painting3.png",id:"painting3"},{src:"painting_explode.png",id:"painting_explode"},{src:"painting_explode2.png",id:"painting_explode2"},{src:"painting_explode3.png",id:"painting_explode3"},{src:"dribble_big.png",id:"dribble_big"},{src:"dribble_small.png",id:"dribble_sm"},{src:"water.png",id:"water"},{src:"music.png",id:"music"},{src:"title.png",id:"title"},{src:"increased_score.png",id:"increased_score"},{src:"star_number.png",id:"star_number"},{src:"0_b.png",id:"0_b"},{src:"1_b.png",id:"1_b"},{src:"2_b.png",id:"2_b"},{src:"3_b.png",id:"3_b"},{src:"4_b.png",id:"4_b"},{src:"5_b.png",id:"5_b"},{src:"6_b.png",id:"6_b"},{src:"7_b.png",id:"7_b"},{src:"8_b.png",id:"8_b"},{src:"9_b.png",id:"9_b"},{src:"tutorial_icon_1.png",id:"tutorial_icon_1"},{src:"tutorial_icon_2.png",id:"tutorial_icon_2"},{src:"tutorial_txt_1.png",id:"tutorial_txt_1"},{src:"tutorial_txt_2.png",id:"tutorial_txt_2"}];startLoader=new createjs.LoadQueue(!1);startLoader.loadManifest([{src:"load_text.png",id:"load_text"},{src:"load_lines.png",id:"load_lines"},{src:"load_text2.png",id:"load_text2"},{src:"logo.png",id:"logo"},{src:"hor2ver.png",id:"hor2ver"},{src:"result_bg_dark.png",id:"result_bg_dark"}],!0,"_assets/art/");startLoader.addEventListener("complete",function(){result_bg_dark=new createjs.Bitmap(startLoader.getResult("result_bg_dark"));window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){90!==window.orientation&&-90!==window.orientation||alert("\u7ad6\u7740\u73a9\u59ff\u52bf\u66f4\u5e05\uff01")},!1);var c=new createjs.SpriteSheet({framerate:24,images:[startLoader.getResult("load_text")],frames:{regX:0,height:240,count:0,regY:0,width:360},animations:{play:[0,7,null,1]}}),b=new createjs.SpriteSheet({framerate:24,images:[startLoader.getResult("load_lines")],frames:{regX:0,height:579,count:0,regY:0,width:360},animations:{play:[0,23,"play",1]}});loadLine=new createjs.Sprite(b,"play");loadResource(loadLine,"loadLine",0,0,2,!1,!0);var d=new createjs.Sprite(c);loadResource(d,"loadText",0,160*scaleY,2,!1,!0);c=new createjs.Bitmap(startLoader.getResult("load_text2"));b=new createjs.Bitmap(startLoader.getResult("logo"));loadResource(c,"loadText2",(w-c.getBounds().width*scaleY)/2,930*scaleY,1,!1,!0);loadResource(b,"logo",(w-b.getBounds().width*scaleY)/2,1080*scaleY,1,!1,!0);var f=setInterval(function(){textIndex++;d.gotoAndStop(textIndex)},5E3);loader=new createjs.LoadQueue(!1);loader.installPlugin(createjs.Sound);var e;loader.on("progress",function(a){e&&stage.removeChild(e);e=new createjs.Text(Math.floor(100*loader.progress)+"%","30px Arial","#ffffff");loadResource(e,"progress",(w-e.getBounds().width*scaleY)/2,885*scaleY,1,!1,!0)});loader.addEventListener("complete",function(){setTimeout(function(){clearInterval(f);loadLine.stop();handleComplete();$("#loadCanvas").css({opacity:"0",transition:"opacity 2s","-moz-transition":"opacity 2s","-webkit-transition":"opacity 2s","-o-transition":"opacity 2s"})},1E3);setTimeout(function(){$("#loadCanvas").hide()},3E3)});loader.loadManifest(a,!0,"_assets/art/");createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED;createjs.Ticker.framerate=24;createjs.Ticker.on("tick",function(){stage.update()})})}function updateScore(a){0==oldArray.length&&stage.removeChild(initalScore);a=a.toString().split("").reverse();var c=w-10*scaleY;for(index in oldArray)stage.removeChild(oldArray[index]);oldArray=[];for(index in a){var b=new createjs.Bitmap(loader.getResult(a[index]+"_b"));oldArray.push(b);c-=b.getBounds().width*scaleY;loadResource(b,a[index]+"_b",c,20*scaleY,1,!1,!0)}}function handleMouseDown(a){oldPt=new createjs.Point(drawStage.mouseX,drawStage.mouseY);oldMidPt=oldPt.clone();drawStage.addEventListener("stagemousemove",handleMouseMove);touchX=drawStage.mouseX;touchY=drawStage.mouseY;currentX=drawStage.mouseX;currentY=drawStage.mouseY;checkTouchedDribble(touchX,touchY);checkTouchedVolume(touchX,touchY)}function handleMouseMove(a){a=new createjs.Point(oldPt.x+drawStage.mouseX>>1,oldPt.y+drawStage.mouseY>>1);drawingCanvas.graphics.clear().setStrokeStyle(30,"round","round").beginStroke("#FFFFFF").moveTo(a.x,a.y).curveTo(oldPt.x,oldPt.y,oldMidPt.x,oldMidPt.y);oldPt.x=drawStage.mouseX;oldPt.y=drawStage.mouseY;oldMidPt.x=a.x;oldMidPt.y=a.y;drawStage.update()}function handleMouseUp(a){currentWidth=Math.abs(drawStage.mouseX-currentX);currentX=(drawStage.mouseX+currentX)/2;currentY=(drawStage.mouseY+currentY)/2;drawStage.removeEventListener("stagemousemove",handleMouseMove);drawStage.clear();checkTouchedPeople(currentX,currentY,currentWidth)}function handleComplete(){function a(){function c(){window.localStorage.setItem("enableTutorial",!1);var a=trainee.clone();peopleLists.push(a);loadResource(a,"tutor",-a.getBounds().width*scaleY*ROLE_SCALE/3,0,ROLE_SCALE,!1,!0);var b=new createjs.Bitmap(loader.getResult("tutorial_icon_1")),c=new createjs.Bitmap(loader.getResult("tutorial_icon_2")),e=new createjs.Bitmap(loader.getResult("tutorial_txt_1")),d=new createjs.Bitmap(loader.getResult("tutorial_txt_2"));loadResource(b,"tutorial_icon_1",140*scaleY,260*scaleY,.8,!1,!0);loadResource(c,"tutorial_icon_2",(230+d.getBounds().width)*scaleY,414*scaleY,1,!1,!0);loadResource(e,"tutorial_txt_1",270*scaleY,(280+e.getBounds().height)*scaleY,1,!1,!0);loadResource(d,"tutorial_txt_2",214*scaleY,390*scaleY,1,!1,!0);peopleComeOut(a,300,!0);createjs.Tween.get(painting).to({y:h-painting.getBounds().width*scaleY*1.54},1E3,createjs.Ease.linear)}hasLevelUp=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];lifeValue=10;score=0;feedback={};stats={};stats.network=networkType;stats.path=pagePath;stats.device=navigator.userAgent;oldArray=[];peopleLists=[];$("#testCanvas").show();$("#drawCanvas").show();startTime=(new Date).getTime();bgm?bgm.play():(bgm=createjs.Sound.play("bgm",{loop:-1}),bgm.volume*=.7);var b=document.getElementById("testCanvas");b.height=window.innerHeight;b.width=window.innerHeight/ratio;stage=new createjs.Stage(b);b=document.getElementById("drawCanvas");b.height=window.innerHeight;b.width=window.innerHeight/ratio;drawStage||(drawStage=new createjs.Stage(b),drawStage.autoClear=!1,createjs.Touch.enable(drawStage),drawStage.enableDOMEvents(!0),drawingCanvas=new createjs.Shape,drawStage.addEventListener("stagemousedown",handleMouseDown),drawStage.addEventListener("stagemouseup",handleMouseUp),drawStage.addChild(drawingCanvas));background=new createjs.Bitmap(loader.getResult("background_dark"));loadResource(background,"background",0,0,1,!1,!0);waterSheet=new createjs.SpriteSheet({framerate:30,images:[loader.getResult("water")],frames:{regX:0,height:180,count:0,regY:0,width:180},animations:{fade:[0,21,null,1]}});var b=new createjs.SpriteSheet({framerate:30,images:[loader.getResult("music")],frames:{regX:0,height:180,count:0,regY:0,width:180},animations:{play:[0,13,"play",1]}}),e=new createjs.SpriteSheet({framerate:24,images:[loader.getResult("intern"),loader.getResult("intern2")],frames:{regX:0,height:300,count:0,regY:0,width:300},animations:{run:[0,15,null,1],speak:[16,47,null,1],back:[15,0,null,1],explode:[48,68,null,1]}}),d=new createjs.SpriteSheet({framerate:24,images:[loader.getResult("boss-1"),loader.getResult("boss-2"),loader.getResult("boss-6"),loader.getResult("boss-3"),loader.getResult("boss-4"),loader.getResult("boss-5")],frames:{regX:0,height:300,count:0,regY:0,width:300},animations:{run:[0,15,null,1],speak:[16,47,null,1],back:[15,0,null,1],open:[48,81,null,1],speak2:[82,129,null,1],explode:[130,150,null,1]}}),f=new createjs.SpriteSheet({framerate:24,images:[loader.getResult("pm-1"),loader.getResult("pm-2"),loader.getResult("pm-3")],frames:{regX:0,height:300,count:0,regY:0,width:300},animations:{run:[0,15,null,1],speak:[16,47,null,1],back:[15,0,null,1],explode:[48,68,null,1]}}),k=new createjs.SpriteSheet({framerate:24,images:[loader.getResult("dev-1"),loader.getResult("dev-2"),loader.getResult("dev-3")],frames:{regX:0,height:300,count:0,regY:0,width:300},animations:{run:[0,15,null,1],speak:[16,47,null,1],back:[15,0,null,1],explode:[48,73,null,1]}});paintSheet=new createjs.SpriteSheet({framerate:30,images:[loader.getResult("painting"),loader.getResult("painting2"),loader.getResult("painting3"),loader.getResult("painting_explode"),loader.getResult("painting_explode2"),loader.getResult("painting_explode3")],frames:{regX:0,height:340,count:0,regY:0,width:440},animations:{appear:[0,0,null,1],dribble1:[1,8,null,1],dribble2:[9,16,null,1],dribble3:[17,24,null,1],dribble4:[25,32,null,1],dribble5:[33,40,null,1],dribble6:[41,48,null,1],dribble7:[49,56,null,1],dribble8:[57,64,null,1],dribble9:[65,72,null,1],dribble10:[73,80,"destory",1],destory:[81,133,null,1]}});trainee=new createjs.Sprite(e);trainee.name="trainee";pm=new createjs.Sprite(f);pm.name="pm";dev=new createjs.Sprite(k);dev.name="dev";boss=new createjs.Sprite(d);boss.name="boss";endLoader=new createjs.LoadQueue(!1);endLoader.loadManifest([{src:"button_again_1.png",id:"button_again_1"},{src:"button_again_2.png",id:"button_again_2"},{src:"button_share_1.png",id:"button_share_1"},{src:"button_share_2.png",id:"button_share_2"},{src:"flag_forwords.png",id:"flag_forwords"},{src:"flag.png",id:"flag"},{src:"number.png",id:"number"},{src:"ending_bg.png",id:"ending_bg"},{src:"star.png",id:"star"},{src:"results.png",id:"results"},{src:"score_title.png",id:"score_title"},{src:"share_indicator.png",id:"share_indicator"},{src:"introducing.png",id:"introducing"},{src:"infor.png",id:"infor"},{src:"close.png",id:"close"}],!0,"_assets/art/");var m,u,r,p,z,D,G,H,v,I,J,K,L,g,E,x,A,B;endLoader.addEventListener("complete",function(){var a=new createjs.SpriteSheet({framerate:24,images:[endLoader.getResult("flag")],frames:{regX:0,height:210,count:0,regY:0,width:320},animations:{waving:[0,24,null,1]}}),b=new createjs.SpriteSheet({framerate:24,images:[endLoader.getResult("results")],frames:{regX:0,height:193,count:0,regY:0,width:208},animations:{calculate:[0,14,null,1]}}),c=new createjs.SpriteSheet({framerate:24,images:[endLoader.getResult("star")],frames:{regX:0,height:35,count:0,regY:0,width:35},animations:{blink:[0,30,"blink",1]}}),e=new createjs.SpriteSheet({framerate:24,images:[endLoader.getResult("number")],frames:{regX:0,height:47,count:0,regY:0,width:38},animations:{set0:[0,0,null,1],set1:[0,1,null,1],set2:[0,2,null,1],set3:[0,3,null,1],set4:[0,4,null,1],set5:[0,5,null,1],set6:[0,6,null,1],set7:[0,7,null,1],set8:[0,8,null,1],set9:[0,9,null,1]}});D=new createjs.Sprite(a,"waving");G=new createjs.Sprite(c,"blink");H=G.clone();star_3=G.clone();v=new createjs.Sprite(e);I=v.clone();J=v.clone();K=v.clone();g=new createjs.Sprite(b);m=new createjs.Bitmap(endLoader.getResult("button_again_1"));u=new createjs.Bitmap(endLoader.getResult("button_again_2"));r=new createjs.Bitmap(endLoader.getResult("button_share_1"));p=new createjs.Bitmap(endLoader.getResult("button_share_2"));z=new createjs.Bitmap(endLoader.getResult("flag_forwords"));L=new createjs.Bitmap(endLoader.getResult("score_title"));E=new createjs.Bitmap(endLoader.getResult("share_indicator"));x=new createjs.Bitmap(endLoader.getResult("introducing"));A=new createjs.Bitmap(endLoader.getResult("infor"));B=new createjs.Bitmap(endLoader.getResult("close"))});painting=new createjs.Sprite(paintSheet,"appear");painting.addEventListener("animationend",function(){if("dribble10"==painting.currentAnimation){bgm.stop();for(index in peopleLists)stage.removeChild(peopleLists[index]);stage.removeAllEventListeners();clearTimeout(timeoutDev);clearTimeout(timeoutPM);clearTimeout(timeoutBoss)}else"destory"==painting.currentAnimation&&(endTime=(new Date).getTime(),stats.time=(new Date).toLocaleString(),stats.hour=(new Date).toLocaleTimeString("en-US",{hour12:!1}).substring(0,2),stats.score=score,stats.network=networkType,stats.device=navigator.userAgent,$.ajax({url:"/shutup/addStat",type:"POST",contentType:"application/json",data:JSON.stringify(stats),dataType:"json",success:function(a){},error:function(){console.log("writing error!")}}),setTimeout(function(){$("#testCanvas").hide();$("#drawCanvas").hide();M(score);$("#endCanvas").show()},2E3))});var N=function(a){0<=a&&50>=a?(g.gotoAndStop(14),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u5565\u4e5f\u4e0d\u662f\uff01",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f"):50<a&&100>=a?(g.gotoAndStop(13),shareTitle="\u8001\u677f\u8bf4\u6211\uff1a\u4f60\u7684\u4e0a\u4e00\u4efd\u5de5\u4f5c\u662f\u5feb\u9012\u5c0f\u54e5\u5417\uff1f",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f"):100<a&&200>=a?(g.gotoAndStop(12),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u65b0\u4e1c\u65b9\u70f9\u996a\u5b66\u6821\u6bd5\u4e1a\u7684\u8bbe\u8ba1\u7814\u7a76\u751f",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f"):200<a&&300>=a?(g.gotoAndStop(11),shareTitle="\u8001\u677f\u8bf4\u6211\uff1a\u8bbe\u8ba1\u505a\u7684\u4e0d\u9519\uff0c\u8299\u84c9\u59d0\u59d0\u7b54\u5e94\u5ac1\u7ed9\u4f60\u4e86",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f"):300<a&&400>=a?(g.gotoAndStop(10),shareTitle="\u8001\u677f\u8bf4\u6211\uff1a\u9aa8\u9abc\u60ca\u5947\uff0c\u4e43\u8bbe\u8ba1\u754c\u7684\u6d2a\u4e03\u516c",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f"):400<a&&450>=a?(g.gotoAndStop(9),shareTitle="\u8001\u677f\u8bf4\u6211\uff1a\u660e\u660e\u53ef\u4ee5\u9760\u989c\u503c\u5403\u996d\uff0c\u504f\u504f\u8981\u7528\u8bbe\u8ba1\u5f81\u670d\u4e16\u754c",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):450<a&&500>=a?(g.gotoAndStop(8),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u6c5f\u5357\u76ae\u9769\u5382\u7684\u9996\u5e2d\u8bbe\u8ba1\u5e08",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):500<a&&550>=a?(g.gotoAndStop(7),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u84dd\u7fd4\u6316\u6398\u673a\u5b66\u6821\u6bd5\u4e1a\u4e13\u4e1a\u62a0\u56fe\u5e08",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):550<a&&600>=a?(g.gotoAndStop(6),shareTitle="\u8001\u677f\u8bf4\u6211\uff1a\u8bbe\u8ba1\u505a\u7684\u4e0d\u9519\uff0c\u516c\u53f8\u7684\u8bbe\u8ba1\u603b\u76d1\u5feb\u5750\u4e0d\u4f4f\u4e86",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):600<a&&700>=a?(g.gotoAndStop(5),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u62c9\u9762\u5e08\u5085\u8f6c\u884c",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):700<a&&800>=a?(g.gotoAndStop(4),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u5413\u5c3f\u522b\u4eba\u7684\u8bbe\u8ba1\u9b3c\u624b",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):800<a&&900>=a?(g.gotoAndStop(3),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u540e\u5382\u6751\u8bbe\u8ba1\u9662\u9662\u58eb",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):900<a&&1200>=a?(g.gotoAndStop(2),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u4e1c\u839e\u5987\u8054\u9996\u5e2d\u7f8e\u5de5",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):1200<a&&1500>=a?(g.gotoAndStop(1),shareTitle="\u8001\u677f\u8bf4\u6211\uff1a\u8ddd\u79bb\u9996\u5e2d\u8bbe\u8ba1\u5e08\u53ea\u5dee\u4e00\u4e2a\u5927\u5634\u5df4",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01"):1500<a&&(g.gotoAndStop(0),shareTitle="\u6211\u5728\u8bbe\u8ba1\u5708\u91cc\u662f\uff1a\u4e0b\u4e00\u4e2a\u4e54\u5e03\u65af",shareContent="\u5899\u88c2\u63a8\u8350\uff01\u8bbe\u8ba1\u5e08\u7684\u4e13\u5c5e\u6e38\u620f\uff01");$.ajax({url:"/shutup/getRank?score\x3d"+a,type:"GET",contentType:"application/json",dataType:"json",success:function(a){configureSharing(a)},error:function(){console.log("writing error!")}})},M=function(b){var c=document.getElementById("endCanvas"),e=new createjs.Sprite(explodeSheet),d=new createjs.Sprite(explodeSheet);c.height=window.innerHeight;c.width=window.innerHeight/ratio;stage=new createjs.Stage(c);c=$("#endCanvas");c.attr("width");c.attr("height");stage=new createjs.Stage(c[0]);c=new createjs.Bitmap(endLoader.getResult("ending_bg"));loadResource(c,"endBackground",0,0,2,!1,!0);loadResource(G,"star1",40*scaleY,h/2,2,!1,!0);loadResource(H,"star2",w-20*scaleY-H.getBounds().width*scaleY*2,h/3,2,!1,!0);loadResource(star_3,"star3",w-50*scaleY-H.getBounds().width*scaleY*2,h/1.5,2,!1,!0);loadResource(z,"flag-body",(w-z.getBounds().width*scaleY*2)/2,-z.getBounds().height*scaleY*2/5,2,!1,!0);loadResource(D,"flag",(w-D.getBounds().width*scaleY*2)/2,4*z.getBounds().width*scaleY*2/5-10,2,!1,!0);D.gotoAndPlay("waving");loadResource(L,"score_title",160*scaleY,60*scaleY,1,!1,!0);loadResource(g,"results",160*scaleY,327*scaleY,2,!1,!0);N(b);createjs.Tween.get(z).to({y:0},500,createjs.Ease.linear);createjs.Tween.get(D).to({y:z.getTransformedBounds().height-1},500,createjs.Ease.linear).call(function(){createjs.Sound.play("result");loadResource(e,"explode",w/2,h/2,1.625,!1,!0);e.gotoAndPlay("explode");createjs.Sound.play("explode");loadResource(d,"explode",w/2-300*scaleY,h/2-300*scaleY,1.625,!1,!0);d.gotoAndPlay("explode");createjs.Sound.play("explode");e.addEventListener("animationend",function(){loadResource(e,"explode",w/2-20*(1+10*Math.random()*scaleY),h/2+10*(1+15*Math.random()*scaleY),1.625,!1,!0);setTimeout(function(){e.gotoAndPlay("explode")},500)});d.addEventListener("animationend",function(){loadResource(d,"explode",w/2-300*scaleY-20*(1+10*Math.random()*scaleY),h/2+10*(1+15*Math.random()*scaleY),1.625,!1,!0);setTimeout(function(){d.gotoAndPlay("explode")},1500)})});loadResource(r,"btnShare_1",36*scaleY,h-(30+r.getBounds().height*scaleY*2),2,!1,!0);loadResource(p,"btnShare_2",36*scaleY,h-(30+p.getBounds().height*scaleY*2),2,!1,!1);loadResource(m,"btnAgain_1",w-36*scaleY-m.getBounds().width*scaleY*2,h-(30+m.getBounds().height*scaleY*2),2,!1,!0);loadResource(u,"btnAgain_2",w-36*scaleY-u.getBounds().width*scaleY*2,h-(30+u.getBounds().height*scaleY*2),2,!1,!1);x.visible=!1;stage.addEventListener("stagemousedown",function(){var a=m.globalToLocal(stage.mouseX,stage.mouseY),b=A.globalToLocal(stage.mouseX,stage.mouseY),c=B.globalToLocal(stage.mouseX,stage.mouseY),p=x.globalToLocal(stage.mouseX,stage.mouseY);m.hitTest(a.x,a.y)?u.visible=!0:A.hitTest(b.x,b.y)?(x.visible=!0,A.visible=!1,B.visible=!0,E.visible=!1):B.hitTest(c.x,c.y)?(x.visible=!1,A.visible=!0,B.visible=!1,E.visible=!0):x.visible&&x.hitTest(p.x,p.y)?360>p.x&&810<p.y?window.location.href="http://research.lenovo.com?time\x3d"+(new Date).getTime():380<p.x&&817<p.y&&(window.location.href="http://mp.weixin.qq.com/mp/profile_ext?action\x3dhome\x26__biz\x3dMzU3NjE0NDY5MA\x3d\x3d#wechat_redirect"):(stage.removeChild(e,d),loadResource(result_bg_dark,"result_bg_dark",0,0,2,!1,!0),loadResource(E,"share_indicator",w-(E.getBounds().width+30)*scaleY,4*scaleY,1,!1,!0),loadResource(A,"infor",44*scaleY,h-(A.getBounds().height+50)*scaleY,1,!1,!0),loadResource(x,"introducing",46*scaleY,98*scaleY,1,!1,!1),loadResource(B,"close",w-(B.getBounds().width+46)*scaleY,26*scaleY,1,!1,!1))});stage.addEventListener("stagemouseup",function(){var b=m.globalToLocal(stage.mouseX,stage.mouseY),c=r.globalToLocal(stage.mouseX,stage.mouseY);m.hitTest(b.x,b.y)&&(u.visible=!1,$("#endCanvas").hide(),a());r.hitTest(c.x,c.y)&&(p.visible=!1)});c=v.getBounds().width;loadResource(v,"number_1",160*scaleY,137*scaleY,2,!1,!0);loadResource(I,"number_2",(160+1*(32+2*c))*scaleY,137*scaleY,2,!1,!0);loadResource(J,"number_3",(160+2*(32+2*c))*scaleY,137*scaleY,2,!1,!0);loadResource(K,"number_4",(160+3*(32+2*c))*scaleY,137*scaleY,2,!1,!0);b=b.toString().split("").reverse();b[0]?K.gotoAndPlay("set"+b[0]):K.gotoAndPlay("set0");b[1]?J.gotoAndPlay("set"+b[1]):J.gotoAndPlay("set0");b[2]?I.gotoAndPlay("set"+b[2]):I.gotoAndPlay("set0");b[3]?v.gotoAndPlay("set"+b[3]):v.gotoAndPlay("set0")};music=new createjs.Sprite(b,"play");var F=new createjs.Sprite(explodeSheet,"explode");loadResource(F,"start_explode",(w-F.getBounds().width*scaleY*2)/2,(h-F.getBounds().height*scaleY*2)/2,2,!1,!0);F.addEventListener("animationend",function(){stage.removeChild(F)});createjs.Sound.play("explode");loadResource(painting,"painting",(w-painting.getBounds().width*scaleY*1.8)/2,h,2,!1,!0);loadResource(music,"music",w-music.getBounds().width*scaleY*.6,h-music.getBounds().height*scaleY*.6,.6,!1,!0);mouth_explode=new createjs.Sprite(explodeSheet);loadResource(mouth_explode,"mouth_explode",0,0,1.625,!1,!1);initalScore=new createjs.Bitmap(loader.getResult("0_b"));loadResource(initalScore,"0_b",w-100*scaleY,20*scaleY,1,!1,!0);star_number_sm=new createjs.Bitmap(loader.getResult("star_number"));loadResource(star_number_sm,"star_number_sm",w-250*scaleY,20*scaleY,1,!1,!0);star_number=new createjs.Bitmap(loader.getResult("star_number"));loadResource(star_number,"star_number",0,0,1.5,!1,!1);b=new createjs.SpriteSheet({framerate:24,images:[loader.getResult("increased_score")],frames:{regX:0,height:54,count:0,regY:0,width:123},animations:{add10:[0,0,null,1],add20:[1,1,null,1],add30:[2,2,null,1],add40:[3,3,null,1]}});increased_score=new createjs.Sprite(b);loadResource(increased_score,"increased_score",0,0,1,!1,!1);"true"==window.localStorage.getItem("enableTutorial")?c():(background.image="/ar"==pagePath?loader.getResult("background2"):loader.getResult("background"),createjs.Tween.get(painting).to({y:h-painting.getBounds().width*scaleY*1.54},1E3,createjs.Ease.linear),loadActors(trainee.clone(),trainee.clone()))}$("#startCanvas").show();startCanvas=document.getElementById("startCanvas");startCanvas.height=window.innerHeight;startCanvas.width=window.innerHeight/ratio;stage=new createjs.Stage(startCanvas);var c=new createjs.SpriteSheet({framerate:30,images:[loader.getResult("start-actor")],frames:{regX:0,height:546,count:0,regY:0,width:360},animations:{play:[0,2,"play",.1]}}),b=new createjs.SpriteSheet({framerate:30,images:[loader.getResult("start-mouth")],frames:{regX:0,height:170,count:0,regY:0,width:270},animations:{play:[0,25,null,1]}});explodeSheet=new createjs.SpriteSheet({framerate:24,images:[loader.getResult("explode")],frames:{regX:0,height:450,count:0,regY:0,width:400},animations:{explode:[0,16,null,1]}});var c=new createjs.Sprite(c,"play"),d=new createjs.Sprite(b,"play"),b=new createjs.Bitmap(loader.getResult("title")),f=new createjs.Bitmap(loader.getResult("wording")),e=new createjs.Bitmap(loader.getResult("guide"));loadResource(loadLine,"loadLine",0,0,2,!1,!0);loadResource(c,"startActor",0,h-c.getBounds().height*scaleY*2*heightScale,2,!1,!0);loadResource(d,"startMouth",(w+d.getBounds().width*scaleY*2)/2,492*scaleY*heightScale,2,!0,!0);d.gotoAndStop(0);loadResource(b,"title",(w-b.getBounds().width*scaleY*2)/2,107*scaleY*heightScale,2,!1,!0);var k=d.getTransformedBounds().width;loadResource(e,"guide",k,750*scaleY*heightScale,2,!1,!0);loadResource(f,"wording",(w-f.getBounds().width*scaleY*2)/2,h-68*scaleY-f.getBounds().height*scaleY*2*heightScale,2,!1,!0);createjs.Tween.get(e,{loop:!0}).to({x:(w-d.getBounds().width*scaleY*2)/2},2E3,createjs.Ease.quartInOut);handleMove=function(b){e.visible=!1;b=b.changedTouches?b.changedTouches[0].clientX:stage.mouseX;var c=k+e.getTransformedBounds().width;b>w-c&&b<w&&(b=(c-b)/c,d.gotoAndStop(parseInt(25*b)),.7<b&&(stage.removeAllEventListeners(),$("#startCanvas").unbind(),$("#startCanvas").hide(),hasStarted||(a(),hasStarted=!0)))};stage.addEventListener("stagemousedown",function(a){e.visible=!1;stage.addEventListener("stagemousemove",handleMove)});stage.addEventListener("stagemouseup",function(a){e.visible=!0;stage.removeEventListener("stagemousemove",handleMove)});startCanvas.addEventListener("touchstart",function(){e.visible=!1;startCanvas.addEventListener("touchmove",handleMove,!1)},!1);startCanvas.addEventListener("touchend",function(){e.visible=!0;startCanvas.removeEventListener("touchmove",handleMove)},!1);startCanvas.addEventListener("touchcancel",function(){e.visible=!0;startCanvas.removeEventListener("touchmove",handleMove)},!1)}function peopleComeOut(a,c,b){if(a){var d=function(a){if("tutor"!=a.name){var d;b?(mouth_explode.x=a.x,star_number.x=a.x+t/2,d=-e):(mouth_explode.x=a.x-e,star_number.x=a.x-e+t/2,d=w+e);star_number.alpha=1;star_number.scaleX=1;star_number.scaleY=1;star_number.y=a.y+t/2;star_number.visible=!0;createjs.Tween.get(star_number).to({x:w-250*scaleY,y:20*scaleY,alpha:.5,scaleX:1/1.5,scaleY:1/1.5},500,createjs.Ease.linear).call(function(){createjs.Sound.play("score");star_number.visible=!1;increased_score.x=w/2;increased_score.y=20*scaleY;increased_score.visible=!0;createjs.Tween.get(increased_score).to({y:0,alpha:.5},800,createjs.Ease.linear).call(function(){increased_score.visible=!1});updateScore(score)});createjs.Tween.get(a).to({x:d},c,createjs.Ease.cubicOut).wait(1E3*(1+Math.random())).call(function(){a.appeared=!1;a.y=a.y>=u?a.y-100*scaleY*Math.random():a.y+100*scaleY*Math.random();a.gotoAndPlay("run")})}mouth_explode.y=a.y;mouth_explode.visible=!0;mouth_explode.gotoAndPlay("explode");createjs.Sound.play("explode");50<=score&&!hasLevelUp[0]?(loadActors(dev.clone(),trainee.clone()),hasLevelUp[0]=!0):100<=score&&!hasLevelUp[1]?(loadActors(pm.clone(),dev.clone(),pm.clone(),trainee.clone()),hasLevelUp[1]=!0):150<=score&&!hasLevelUp[2]?(loadActors(dev.clone(),pm.clone(),trainee.clone(),dev.clone()),hasLevelUp[2]=!0):200<=score&&!hasLevelUp[3]?(loadActors(pm.clone(),dev.clone(),boss.clone(),trainee.clone()),hasLevelUp[3]=!0):250<=score&&!hasLevelUp[4]?(loadActors(trainee.clone(),boss.clone(),dev.clone(),pm.clone()),hasLevelUp[4]=!0):400<=score&&!hasLevelUp[5]?(loadActors(pm.clone(),dev.clone(),dev.clone(),trainee.clone()),hasLevelUp[5]=!0):450<=score&&!hasLevelUp[6]?(loadActors(pm.clone(),boss.clone(),trainee.clone(),dev.clone()),hasLevelUp[6]=!0):700<=score&&!hasLevelUp[7]?(loadActors(boss.clone(),pm.clone(),pm.clone(),dev.clone(),trainee.clone(),trainee.clone()),hasLevelUp[7]=!0):850<=score&&!hasLevelUp[8]?(loadActors(boss.clone(),pm.clone(),boss.clone(),dev.clone(),pm.clone(),trainee.clone()),hasLevelUp[8]=!0):1E3<=score&&!hasLevelUp[9]?(loadActors(pm.clone(),boss.clone(),pm.clone(),boss.clone(),boss.clone(),trainee.clone()),hasLevelUp[9]=!0):1100<=score&&!hasLevelUp[10]?(loadActors(boss.clone(),pm.clone(),boss.clone(),dev.clone(),boss.clone(),pm.clone()),hasLevelUp[10]=!0):1200<=score&&!hasLevelUp[11]?(loadActors(boss.clone(),dev.clone(),pm.clone(),trainee.clone(),dev.clone(),pm.clone(),trainee.clone(),boss.clone()),hasLevelUp[11]=!0):1500<=score&&!hasLevelUp[12]&&(loadActors(boss.clone(),boss.clone(),dev.clone(),boss.clone(),pm.clone(),trainee.clone(),pm.clone(),pm.clone()),hasLevelUp[12]=!0)},f=function(a){if(void 0!=a&&"tutor"!=a.name){var c;b?(l.x=a.x+e/2*1.1,q.x=a.x+e/2*.9,n.x=a.x+e/2*.7,c=w/2*.7):(l.x=a.x-e/2*.8,q.x=a.x-e/2*1.1,n.x=a.x-e/3,c=w/2*1.3);l.y=a.y+k/2;l.rotation=-20;l.visible=!0;l.alpha=1;createjs.Tween.get(l).to({x:1.1*l.x,y:l.y+20*scaleY,alpha:0},y,createjs.Ease.linear);q.y=a.y+k/2;q.rotation=20;q.visible=!0;q.alpha=1;createjs.Tween.get(q).to({x:.9*q.x,y:l.y+20*scaleY,alpha:0},y,createjs.Ease.linear);n.y=a.y+k/2*.9;n.visible=!0;n.gotoAndStop(0);createjs.Tween.get(n).to({x:c,y:.7*h},y,createjs.Ease.linear).call(function(){n.visible=!1;createjs.Sound.play("drop");0<lifeValue&&0==n.currentFrame&&(lifeValue--,painting.gotoAndPlay("dribble"+(10-lifeValue)))})}},e=a.getTransformedBounds().width,k=a.getTransformedBounds().height,t=mouth_explode.getTransformedBounds().width,C,y;if("trainee"==a.name)C=3,y=1500;else if("dev"==a.name)C=3,y=1300;else if("pm"==a.name)C=2,y=1300;else if("pm"==a.name||"boss"==a.name)C=2,y=1100;var l=new createjs.Bitmap(loader.getResult("dribble_sm")),q=l.clone(),n=new createjs.Sprite(waterSheet,"fade");a.dribbles=n;var m;loadResource(l,a.name+"dribble_sm",0,0,1,!1,!1);loadResource(q,a.name+"dribble_sm_2",0,0,1,!0,!1);b?(loadResource(n,a.name+"dribble_bg",0,0,1,!1,!1),m="tutor"==a.name||b?-10*(1+scaleY*Math.random()):-110*scaleY*Math.random()):(loadResource(n,a.name+"dribble_bg",0,0,1,!0,!1),m=w+110*scaleY*Math.random());a.exploded=!1;a.appeared=!1;"boss"==a.name&&(a.hasFirstShut=!1);a.gotoAndPlay("run");var u=a.y,r=1;a.addEventListener("change",function(){1!=a.currentFrame||a.appeared?20==a.currentFrame?(r++,0!=r%C||a.exploded||f(a)):83!=a.currentFrame||a.exploded?"explode"==a.currentAnimation&&(a.exploded=!0):f(a):(a.exploded=!1,createjs.Sound.play("appear"),createjs.Tween.get(a).to({x:m},c,createjs.Ease.backOut).call(function(){a.appeared=!0}))});a.addEventListener("animationend",function(){"run"==a.currentAnimation?a.gotoAndPlay("speak"):"speak"==a.currentAnimation?a.gotoAndPlay("speak"):"open"==a.currentAnimation?(createjs.Sound.play("open_mouth"),a.gotoAndPlay("speak2")):"speak2"==a.currentAnimation?a.gotoAndPlay("speak2"):"explode"==a.currentAnimation&&(d(a),r=1)})}}function loadActors(a,c,b,d,f,e,k,t){for(index in peopleLists)stage.removeChild(peopleLists[index]);for(index in timeoutList)clearTimeout(timeoutList[index]);peopleLists=[];timeoutList=[];2==arguments.length?(peopleLists.push(a,c),loadResource(a,a.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.3*h*Math.random(),ROLE_SCALE,!1,!0),loadResource(c,c.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.3*h*Math.random(),ROLE_SCALE,!0,!0),stage.swapChildren(c,star_number_sm),timeoutList[0]=setTimeout(function(){peopleComeOut(a,300,!0)},1500),timeoutList[1]=setTimeout(function(){peopleComeOut(c,300,!1)},500)):4==arguments.length?(peopleLists.push(a,c,b,d),loadResource(a,a.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.1*h*Math.random(),ROLE_SCALE,!1,!0),loadResource(c,c.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.2+.1*Math.random()),ROLE_SCALE,!1,!0),loadResource(b,b.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.1*h*Math.random(),ROLE_SCALE,!0,!0),loadResource(d,d.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.2+.1*Math.random()),ROLE_SCALE,!0,!0),stage.swapChildren(b,star_number_sm),timeoutList[0]=setTimeout(function(){peopleComeOut(a,300,!0)},500),timeoutList[1]=setTimeout(function(){peopleComeOut(c,300,!0)},1500),timeoutList[2]=setTimeout(function(){peopleComeOut(b,300,!1)},3E3),timeoutList[3]=setTimeout(function(){peopleComeOut(d,300,!1)},3500)):6==arguments.length?(peopleLists.push(a,c,b,d,f,e),loadResource(a,a.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.1*h*Math.random(),ROLE_SCALE,!1,!0),loadResource(c,c.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.1+.1*Math.random()),ROLE_SCALE,!1,!0),loadResource(b,b.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.3+.1*Math.random()),ROLE_SCALE,!1,!0),loadResource(d,d.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.1*h*Math.random(),ROLE_SCALE,!0,!0),loadResource(f,f.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.1+.1*Math.random()),ROLE_SCALE,!0,!0),loadResource(e,e.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.3+.1*Math.random()),ROLE_SCALE,!0,!0),stage.swapChildren(d,star_number_sm),timeoutList[0]=setTimeout(function(){peopleComeOut(a,300,!0)},500),timeoutList[1]=setTimeout(function(){peopleComeOut(c,300,!0)},1500),timeoutList[2]=setTimeout(function(){peopleComeOut(b,300,!0)},2E3),timeoutList[3]=setTimeout(function(){peopleComeOut(d,300,!1)},2500),timeoutList[4]=setTimeout(function(){peopleComeOut(f,300,!1)},3E3),timeoutList[5]=setTimeout(function(){peopleComeOut(e,300,!1)},3500)):8==arguments.length&&(peopleLists.push(a,c,b,d,f,e,k,t),loadResource(a,a.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.1*h*Math.random(),ROLE_SCALE,!1,!0),loadResource(c,c.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.1+.1*Math.random()),ROLE_SCALE,!1,!0),loadResource(b,b.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,.1*h*Math.random(),ROLE_SCALE,!0,!0),loadResource(d,d.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.1+.1*Math.random()),ROLE_SCALE,!0,!0),loadResource(f,f.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.2+.1*Math.random()),ROLE_SCALE,!1,!0),loadResource(e,e.name,-ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.2+.1*Math.random()),ROLE_SCALE,!1,!0),loadResource(k,k.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.3+.1*Math.random()),ROLE_SCALE,!0,!0),loadResource(t,t.name,w+ACTOR_WIDTH*scaleY*ROLE_SCALE/3,h*(.3+.1*Math.random()),ROLE_SCALE,!0,!0),stage.swapChildren(b,star_number_sm),timeoutList[0]=setTimeout(function(){peopleComeOut(a,300,!0)},500),timeoutList[1]=setTimeout(function(){peopleComeOut(c,300,!0)},1E3),timeoutList[2]=setTimeout(function(){peopleComeOut(b,300,!1)},1500),timeoutList[3]=setTimeout(function(){peopleComeOut(d,300,!1)},2E3),timeoutList[4]=setTimeout(function(){peopleComeOut(f,300,!0)},2500),timeoutList[5]=setTimeout(function(){peopleComeOut(e,300,!0)},3E3),timeoutList[6]=setTimeout(function(){peopleComeOut(k,300,!1)},3500),timeoutList[7]=setTimeout(function(){peopleComeOut(t,300,!1)},4E3))}var checkTouchedPeople=function(a,c,b){for(index in peopleLists){var d=peopleLists[index].globalToLocal(a,c);peopleLists[index].hitTest(d.x,d.y)&&!peopleLists[index].exploded&&checkMouth2(currentX,currentY,b,peopleLists[index])&&("boss"==peopleLists[index].name?0==peopleLists[index].hasFirstShut?(peopleLists[index].gotoAndPlay("open"),peopleLists[index].hasFirstShut=!0):1==peopleLists[index].hasFirstShut&&(peopleLists[index].exploded=!0,peopleLists[index].gotoAndPlay("explode"),createjs.Sound.play("shutup"),peopleLists[index].hasFirstShut=!1,score+=10):(peopleLists[index].exploded=!0,peopleLists[index].gotoAndPlay("explode"),createjs.Sound.play("shutup"),"tutor"!=peopleLists[index].name&&(score+=10)))}};function checkMouth2(a,c,b,d){var f=260/2.17+70/2.17/2,e=d.getTransformedBounds().width/3;.2>Math.abs(1-d.globalToLocal(a,c).y/f)&&.7<b/e?(a=!0,"tutor"==d.name&&(d.gotoAndPlay("explode"),createjs.Sound.play("shutup"),stage.removeChild(stage.getChildByName("tutorial_txt_1"),stage.getChildByName("tutorial_txt_2"),stage.getChildByName("tutorial_icon_1"),stage.getChildByName("tutorial_icon_2")),setTimeout(function(){createjs.Tween.get(background).to({alpha:0},500,createjs.Ease.linear).call(function(){background.image="/ar"==pagePath?loader.getResult("background2"):loader.getResult("background");loadActors(trainee.clone(),trainee.clone())})},3E3))):a=!1;return a}var checkTouchedDribble=function(a,c){for(index in peopleLists)if(peopleLists[index].dribbles){var b=peopleLists[index].dribbles.globalToLocal(a,c);peopleLists[index].dribbles.hitTest(b.x,b.y)&&peopleLists[index].dribbles.gotoAndPlay("fade")}},checkTouchedVolume=function(a,c){var b=music.globalToLocal(a,c);music.hitTest(b.x,b.y)&&(createjs.Sound.muted?(createjs.Sound.muted=!1,music.gotoAndPlay(0)):(createjs.Sound.muted=!0,music.gotoAndStop(0)))},loadResource=function(a,c,b,d,f,e,k){a&&(a.scaleX=e?-scaleY*f:scaleY*f,a.scaleY=scaleY*f,a.x=b,a.y=d,a.name=c,a.exploded=!1,a.visible=k,stage.addChild(a))};